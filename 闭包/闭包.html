<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>闭包</title>
</head>
<body>

<ul id="box">
    <li>列表</li>
    <li>列表</li>
    <li>列表</li>
    <li>列表</li>
    <li>列表</li>
    <li>列表</li>
    <li>列表</li>
    <li>列表</li>
    <li>列表</li>
    <li>列表</li>
</ul>


<script>
    /*
     ----执行上下文（作用域）、 变量对象、this指针

    * 闭包是由函数实现，函数的一种存在方式；（是一种怎样的方式？？）
    *
    * 闭包能够保护和保存变量，执行后不会被垃圾回收机制回收；(如何保存和保护)
    *
    
     使用场景，面试题
    
    * ------------------
    * 内存回收机制是指不在用到的内存，系统自动进行回收从而清理出空间供其它程序使用；
    *
    * 一般程序在执行的时候会占用内存，执行完毕就会释放内存，释放的内存系统会自动进行回收。
    *
    * 闭包则不会执行完释放内存，这是好处也是坏处。
    *
    * 堆和栈的存储形式
    * 栈（stack）为自动分配的内存空间，它由系统自动释放；
    * 而堆（heap）则是动态分配的内存，大小不定也不会自动释放。
    *
    *                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
    * */
    var box = document.getElementById('box');
    var list = box.getElementsByTagName('li');
    var len = list.length;

/*
    for (var i=0; i<len; i++){
       list[i].onclick = function () {
           alert(i);
       }
    }
*/

   /*
   * 匿名函数传参
   * 匿名函数立即执行函数
   * */
    for (var i=0; i<len; i++){
       ~(function (i) {
            console.log('输出i的值',i);
            // 这里使用了匿名函数创建了一个作用域，形成闭包，保存了变量i
            list[i].onclick = function () {
                alert(i);
            }
        })(i);
    }

/*
函数是一种复杂的数据类型，可以看作是一种特殊的对象，因此两个不同的函数是不相等的
闭包返回的是一个函数，因此形成自己单独的作用域
*/
    var age = 10;
    function t1(){
        var age = 20;
        return function t2(){
             ++age;
             console.log(age)
        }
    }
    var t3 = t1();
    t3(); // 21
    t3(); // 22
    t3(); // 23
    console.log(age,'--------------'); //10

    var t4 = t1();
    var t5 = t1();
    var t6 = t4;
    t4();
    t4();
    t6();
    t6();
    t6();
    console.log(t4 == t5) 
    console.log('t4和t6', t4==t6)
    let obj1={
        a:1,
        b:2
    }
    let obj2 = {
        a:1,
        b:2
    }
 console.log(obj1==obj2)

</script>

</body>
</html>
